<div class="headerActions">
  <h3 style="float: left;"><i nz-icon nzType="file-done" nzTheme="outline" style="color: #1890FF"></i> Discharge Form</h3>
  <button nz-button nzType="default" (click)="excel(); $event.preventDefault();" style="margin-right: 10px;">
    <i nz-icon nzType="file-excel" nzTheme="outline" style="color: #008141"></i>
    EXPORT TO EXCEL
  </button>
  <button nz-button (click)="convertToPDF();" nzType="default" style="margin-right: 10px;">
    <span nz-icon nzType="file-pdf" nzTheme="outline" style="color: red;"></span>
    EXPORT TO PDF
  </button>
  <button nz-button nzType="primary" (click)="$event.preventDefault();" [useExistingCss]="true"
  printSectionId="print-section"
  ngxPrint>
    <i nz-icon nzType="printer" nzTheme="outline"></i>
    PRINT
  </button>
</div>

<nz-spin nzTip="Generating Form ..." [nzSpinning]="isLoading">
  <div class="printLayout printContent" id="print-section">
    <div id="contentpdf" #contentpdf>
      <div class="" id="report-section">
        <app-header-print></app-header-print>
        <div style="text-align: center;"><h2>WOMEN AND CHILDREN CRISIS CENTER</h2></div>
        <div style="text-align: center;"><h2><b>DISCHARGE FORM</b></h2></div>
        <br>
        <div class="content">
          <div nz-row>
            <div nz-col nzSpan="22" nzOffset="1">
              <div nz-row nzJustify="end">
                <div nz-col nzSpan="5" style="text-align: center;border-bottom: 1px solid black">
                  {{transDate | date:'MMMM d, y' }}
                </div>
              </div>
              <nz-descriptions [nzColon]="false" style="margin-top: 5%;">
                <nz-descriptions-item nzTitle="The Client/s:" [nzSpan]="2">
                  <!-- <div style="text-align: center;">
                    <b>{{tocData?.client_pname+" "}}{{tocData?.client_age == '' ? "" : ", "+tocData?.client_page+" Years Old" }}</b>
                  </div> -->
                </nz-descriptions-item>
              </nz-descriptions>
              <div nz-row nzJustify="center">
                <div nz-col nzSpan="16" style="text-align: center;border-bottom: 1px solid black">
                  <b>{{dfData?.client_pname+" "}}{{dfData?.client_age == '' ? "" : ", "+dfData?.client_page+" Years Old" }}</b>
                </div>
              </div>
              <br><br><br><br>
              <!-- <nz-descriptions [nzColon]="false" style="margin-top: 5%;">
                <nz-descriptions-item nzTitle="With:" [nzSpan]="2">
                  <div style="text-align: center;">
                    <b>{{tocData?.guardian_pname}}</b>
                  </div>
                </nz-descriptions-item>
              </nz-descriptions> -->
              <!-- <nz-descriptions [nzColon]="false">
                <nz-descriptions-item nzTitle="Resident of/ Office Address," [nzSpan]="2">
                  <div class="border">
                    {{tocData?.client_address}}
                  </div>
                </nz-descriptions-item>
              </nz-descriptions> -->
  
              <div nz-col nzSpan="24">
                <div nz-row>
                  <div nz-col nzSpan="14">
                    <nz-descriptions  nzColon="false">
                      <nz-descriptions-item nzTitle="Is/ are discharge to" [nzSpan]="1.5">
                        <div class="border" style="text-align: center;">
                          <!-- Applicant here -->
                          {{dfData?.guardian_pname}}
                        </div>
                      </nz-descriptions-item>
                    </nz-descriptions>
  
                    <div nz-row nzJustify="center">
                      <div nz-col [nzSpan]="24" style="margin-top: -12px;margin-left: 85%;">
                        <span style="font-style: italic; font-size: 12px;">Name of Family Member/ Officer In-Charge</span>
                      </div>
                    </div>
                  </div>
                  <div nz-col nzSpan="10">
                    <nz-descriptions  nzColon="false">
                      <nz-descriptions-item nzTitle="," [nzSpan]="1.5">
                        <div class="border" style="text-align: center;">
                          <!-- Applicant here -->
                          {{dfData?.family_id == null ? "Guardian" : "Parent/ Family Relative"}}
                        </div>
                      </nz-descriptions-item>
                    </nz-descriptions>
  
                    <div nz-row nzJustify="center">
                      <div nz-col [nzSpan]="24" style="margin-top: -12px;margin-left: 60%;">
                        <span style="font-style: italic; font-size: 12px;">Relation to Client/ Office Agency</span>
                      </div>
                    </div>
                  </div>
                </div>
  
  
              </div>
              <br>
              <br><br>
  
                <div nz-row>
                  <div nz-col nzSpan="24">
                    <div nz-row nzJustify="start">
                      <div nz-col nzSpan="9">
  
                        <br><br>
                        <div style="text-align: center">
                          <div style="border-bottom: 1px solid black">
                            <!-- <span style="text-transform: uppercase;">{{desinatedOfficer}}</span> -->
                          </div>
                        <span><b>Signature of Family Member</b></span>
                        </div>
                      </div>
                    </div>
                    <br><br>
                  </div>
                  <div nz-col nzSpan="24">
                    <div nz-row nzJustify="end">
                      <div nz-col nzSpan="9">
  
                        <br><br>
                        <div style="text-align: center">
                          <div style="border-bottom: 1px solid black">
                            <!-- <span style="text-transform: uppercase;">{{desinatedOfficer}}</span> -->
                          </div>
                        <span><b>Signature of Client</b></span>
                        </div>
                      </div>
                    </div>
                    <br><br>
                  </div>
                  <div nz-col nzSpan="24">
  
                    <span>Witnesses:</span>
                    <br><br>
                    <div nz-row nzJustify="space-between">
                      <div nz-col nzSpan="9">
                        <div style="text-align: center;border-bottom: 1px solid black">
                          {{wtnsData1 == null ? "None" : wtnsData1.wcc_df_witness_pname}}
                          <!-- {{registrationData?.transaction_date | date:'EEEE, MMMM d, y, h:mm:ss a' }} -->
                        </div>
                      </div>
                      <div nz-col nzSpan="9">
                        <div style="text-align: center;border-bottom: 1px solid black">
                          {{wtnsData2 == null ? "None" : wtnsData2.wcc_df_witness_pname}}
                          <!-- {{registrationData?.transaction_date | date:'EEEE, MMMM d, y, h:mm:ss a' }} -->
                        </div>
                      </div>
                    </div>
                    <br><br><br><br>
                    <div nz-row nzJustify="start">
                      <div>
                        <div>
                          <span>{{dfData?.officer_pname}}</span><br>
                          <span>{{dfData?.officer_eoffice}} - <i>{{dfData?.officer_eposition}}</i></span>
  
                        </div>
                      </div>
                    </div>
  
                    <br><br>
                    <div nz-row nzJustify="end">
                      <div nz-col nzSpan="8">
                        <span>Noted by: Approved by:</span>
                        <br><br>
                        <div>
                          <div style="border-bottom: 1px solid black">
                            <span style="text-transform: uppercase;">{{desinatedOfficer}}</span>
                          </div>
                        <span>{{designation}}</span>
                        </div>
                      </div>
                    </div>
                    <br>
                  </div>
                </div>
  
              </div>
              <br>
              <br>
            </div>
  
        </div>
  
        <div class="footDiv">
          <app-footer-print ></app-footer-print>
        </div>
      
        <div class="footDivPrint">
          <app-footer-print></app-footer-print>
        </div>
  
      </div>
    </div>
    
  </div>

</nz-spin>
